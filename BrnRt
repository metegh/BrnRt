local HttpService = game:GetService("HttpService")
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()

-- üîπ PandaAuth –ù–∞—Å—Ç—Ä–æ–π–∫–∏
local API_KEY = "84a02f231b73ee4f6c6a8eb3e82a6198523c32e1dcf19f09e8bc132f72f0b497"
local SERVICE_IDENTIFIER = "rblhub" -- —Ç–≤–æ–π Identifier Name
local API_URL = "https://api.pandadevelopment.net/api/user"
local KEY_LINK = "https://pandaauth.gg/rblhub" -- –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞

-- üîπ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–∞
SaveManager:SetLibrary(Fluent)
SaveManager:SetFolder("MyHubKeySystem")
SaveManager:BuildConfigSection()

local Window = Fluent:CreateWindow({
    Title = "Key System | PandaAuth",
    SubTitle = "by PandaDevelopment",
    TabWidth = 160,
    Size = UDim2.fromOffset(400, 200),
    Acrylic = true,
    Theme = "Dark"
})

local Tabs = {
    Main = Window:AddTab({ Title = "Key System", Icon = "" })
}

local userKey = ""
local configName = "SavedKey"

-- ‚úÖ –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—é—á–∞
local function CheckKey(Key)
    local Response
    local success, err = pcall(function()
        Response = syn.request({
            Url = API_URL,
            Method = "GET",
            Headers = {
                ["Authorization"] = "Bearer " .. Key,
                ["x-api-key"] = API_KEY,
                ["service"] = SERVICE_IDENTIFIER
            }
        })
    end)

    if not success or not Response or Response.StatusCode ~= 200 then
        Fluent:Notify({
            Title = "–û—à–∏–±–∫–∞",
            Content = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –∏–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ!",
            Duration = 5
        })
        return false
    end

    local Data = HttpService:JSONDecode(Response.Body)

    if Data and Data.id then
        Fluent:Notify({
            Title = "–£—Å–ø–µ—Ö!",
            Content = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, " .. Data.username,
            Duration = 5
        })

        -- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–ª—é—á
        SaveManager:SetIgnoreIndexes({})
        SaveManager:Save(configName)
        writefile("MyHubKeySystem/" .. configName .. ".txt", Key)

        -- ‚úÖ –ó–∞–ø—É—Å–∫ —Ç–≤–æ–µ–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ö–∞–±–∞
        task.wait(1)
        loadstring(game:HttpGet("https://pastebin.com/raw/–í–ê–®_–•–ê–ë"))()

        return true
    end

    Fluent:Notify({
        Title = "–û—à–∏–±–∫–∞",
        Content = "–ö–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω!",
        Duration = 5
    })
    return false
end

-- ‚úÖ –¢–ï–ö–°–¢–ë–û–ö–° –î–õ–Ø –í–í–û–î–ê –ö–õ–Æ–ß–ê
local KeyInput = Tabs.Main:AddInput("KeyInput", {
    Title = "–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á:",
    Default = "",
    Placeholder = "–í–∞—à PandaAuth –∫–ª—é—á",
    Finished = true,
    Callback = function(Value)
        userKey = Value
    end
})

-- ‚úÖ –ö–ù–û–ü–ö–ê –ü–†–û–í–ï–†–ö–ò –ö–õ–Æ–ß–ê
Tabs.Main:AddButton({
    Title = "‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–ª—é—á",
    Callback = function()
        if userKey == "" then
            return Fluent:Notify({Title = "–û—à–∏–±–∫–∞", Content = "–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á!", Duration = 5})
        end
        CheckKey(userKey)
    end
})

-- ‚úÖ –ö–ù–û–ü–ö–ê –ü–û–õ–£–ß–ï–ù–ò–Ø –ö–õ–Æ–ß–ê
Tabs.Main:AddButton({
    Title = "üîó –ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á",
    Callback = function()
        setclipboard(KEY_LINK)
        Fluent:Notify({
            Title = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!",
            Content = "–°—Å—ã–ª–∫–∞ –Ω–∞ PandaAuth —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞.",
            Duration = 5
        })
    end
})

-- ‚úÖ –ê–í–¢–û–ó–ê–ì–†–£–ó–ö–ê –ö–õ–Æ–ß–ê (–µ—Å–ª–∏ —É–∂–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω)
if isfile("MyHubKeySystem/" .. configName .. ".txt") then
    local savedKey = readfile("MyHubKeySystem/" .. configName .. ".txt")
    if savedKey and savedKey ~= "" then
        print("–ù–∞–π–¥–µ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –∫–ª—é—á:", savedKey)
        CheckKey(savedKey)
    end
end
